<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Car Scan MVP</title>
  </head>
  <body style="font-family: Arial; text-align:center; padding:40px;">
    <h2>Is this car causing an issue?</h2>

    <p style="color:gray;">
      Sticker ID:
      <strong id="sticker">unknown</strong>
    </p>

<button onclick="send('Blocking my car')">üöó Blocking my car</button><br><br>
<button onclick="send('Lights left on')">üî¶ Lights left on</button><br><br>
<button onclick="send('Other issue')">‚ö†Ô∏è Other issue</button>

<p id="status" style="margin-top:20px; color:green;"></p>

<script>
 <script>
  const params = new URLSearchParams(window.location.search);
  const id = params.get("id");

  if (id) {
    document.getElementById("sticker").innerText = id;
  }

  async function send(reason) {
    const phone = localStorage.getItem("owner_" + id);
    const status = document.getElementById("status");

    if (!phone) {
      status.innerText = "Owner not registered yet.";
      return;
    }

    status.innerText = "Sending message...";

    const res = await fetch("/api/send-sms", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        phone: phone,
        message: `Car alert (${id}): ${reason}`,
      }),
    });

    if (res.ok) {
      status.innerText = "Message sent to vehicle owner.";
    } else {
      status.innerText = "Failed to send message.";
    }
  }
</script>

</script>


    <p style="margin-top:40px; font-size:12px; color:gray;">
      No personal data is shown.
    </p>

    <script>
      const params = new URLSearchParams(window.location.search);
      const id = params.get("id");
      if (id) {
        document.getElementById("sticker").innerText = id;
      }
    </script>
  </body>
</html>
